!function t(e,i,s){function r(h,o){if(!i[h]){if(!e[h]){var a="function"==typeof require&&require;if(!o&&a)return a(h,!0);if(n)return n(h,!0);var c=new Error("Cannot find module '"+h+"'");throw c.code="MODULE_NOT_FOUND",c}var d=i[h]={exports:{}};e[h][0].call(d.exports,function(t){var i=e[h][1][t];return r(i?i:t)},d,d.exports,t,e,i,s)}return i[h].exports}for(var n="function"==typeof require&&require,h=0;h<s.length;h++)r(s[h]);return r}({1:[function(t,e,i){e.exports=t("pixi.js").cocoonText={CocoonText:t("./CocoonText")}},{"./CocoonText":3,"pixi.js":"pixi.js"}],2:[function(t,e,i){e.exports={TEXT_RESOLUTION:1}},{}],3:[function(t,e,i){function s(t,e,i){this.canvas=null,this.context=null,this.resolution=i||n.TEXT_RESOLUTION||r.CONST.RESOLUTION,this._text=null,this._style=null,this._generatedStyle=null,this._pixiId=t+JSON.stringify(e)+this.resolution;var s=r.utils.BaseTextureCache[this._pixiId];s?(this.canvas=s.source,this.cacheDirty=!1):(this.canvas=document.createElement("canvas"),this.canvas._pixiId=this._pixiId,this.cacheDirty=!0),this.context=this.canvas.getContext("2d");var h=r.Texture.fromCanvas(this.canvas);h.trim=new r.math.Rectangle,r.Sprite.call(this,h),this.text=t,this.style=e,this._generatedStyle=e}var r=t("pixi.js"),n=t("../CocoonTextUtil");s.prototype=Object.create(r.Sprite.prototype),s.prototype.constructor=s,e.exports=s,Object.defineProperties(s.prototype,{width:{get:function(){return this.dirty&&this.updateText(),this.scale.x*this._texture._frame.width},set:function(t){this.scale.x=t/this._texture._frame.width,this._width=t}},height:{get:function(){return this.dirty&&this.updateText(),this.scale.y*this._texture._frame.height},set:function(t){this.scale.y=t/this._texture._frame.height,this._height=t}},style:{get:function(){return this._style},set:function(t){t=t||{},t.font=t.font||"bold 20px Arial",t.fill=t.fill||"black",t.align=t.align||"left",t.stroke=t.stroke||"black",t.strokeThickness=t.strokeThickness||0,t.wordWrap=t.wordWrap||!1,t.wordWrapWidth=t.wordWrapWidth||100,t.dropShadow=t.dropShadow||!1,t.dropShadowColor=t.dropShadowColor||"#000000",t.dropShadowAngle=t.dropShadowAngle||Math.PI/6,t.dropShadowDistance=t.dropShadowDistance||5,t.padding=t.padding||0,t.textBaseline=t.textBaseline||"alphabetic",t.lineJoin=t.lineJoin||"miter",t.miterLimit=t.miterLimit||10,this._generatedStyle=t,this._generatedStyle.font=t.font.replace(/[0-9]+/,Math.round(parseInt(t.font.match(/[0-9]+/)[0],10)*this.resolution)),this._generatedStyle.strokeThickness=Math.round(t.strokeThickness*this.resolution),this._generatedStyle.wordWrapWidth=Math.round(t.wordWrapWidth*this.resolution),this._generatedStyle.dropShadowDistance=Math.round(t.dropShadowDistance*this.resolution),this._generatedStyle.padding=Math.round(t.padding*this.resolution),null!==this._style&&this.prepareUpdateText(this._text,t),this._style=t,this.dirty=!0}},text:{get:function(){return this._text},set:function(t){t=t.toString()||" ",this._text!==t&&(null!==this._text&&this.prepareUpdateText(t,this._style),this._text=t,this.dirty=!0)}}}),s.prototype.prepareUpdateText=function(t,e){this._pixiId=t+JSON.stringify(e)+this.resolution;var i=r.utils.BaseTextureCache[this._pixiId];if(i){this.canvas=i.source,this.context=this.canvas.getContext("2d"),this.cacheDirty=!1;var s=r.Texture.fromCanvas(this.canvas);s.trim=new r.math.Rectangle,this.texture=s,this._texture=s}else{this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.canvas._pixiId=this._pixiId,this.cacheDirty=!0;var s=r.Texture.fromCanvas(this.canvas);s.trim=new r.math.Rectangle,this.texture=s,this._texture=s}},s.prototype.updateText=function(){if(this.cacheDirty){var t=this._generatedStyle;this.context.font=t.font;for(var e=t.wordWrap?r.Text.wordWrap(this._text):this._text,i=e.split(/(?:\r\n|\r|\n)/),s=new Array(i.length),n=0,h=r.Text.determineFontProperties(t.font),o=0;o<i.length;o++){var a=this.context.measureText(i[o]).width;s[o]=a,n=Math.max(n,a)}var c=n+t.strokeThickness;t.dropShadow&&(c+=t.dropShadowDistance),this.canvas.width=c+this.context.lineWidth;var d=this.style.lineHeight||h.fontSize+t.strokeThickness,l=d*i.length;t.dropShadow&&(l+=t.dropShadowDistance),this.canvas.height=l+2*this._style.padding,navigator.isCocoonJS&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.font=t.font,this.context.strokeStyle=t.stroke,this.context.lineWidth=t.strokeThickness,this.context.textBaseline=t.textBaseline,this.context.lineJoin=t.lineJoin,this.context.miterLimit=t.miterLimit;var p,u;if(t.dropShadow){this.context.fillStyle=t.dropShadowColor;var x=Math.cos(t.dropShadowAngle)*t.dropShadowDistance,f=Math.sin(t.dropShadowAngle)*t.dropShadowDistance;for(o=0;o<i.length;o++)p=t.strokeThickness/2,u=t.strokeThickness/2+o*d+h.ascent,"right"===t.align?p+=n-s[o]:"center"===t.align&&(p+=(n-s[o])/2),t.fill&&this.context.fillText(i[o],p+x,u+f+this._style.padding)}for(this.context.fillStyle=t.fill,o=0;o<i.length;o++)p=t.strokeThickness/2,u=t.strokeThickness/2+o*d+h.ascent,"right"===t.align?p+=n-s[o]:"center"===t.align&&(p+=(n-s[o])/2),t.stroke&&t.strokeThickness&&this.context.strokeText(i[o],p,u+this._style.padding),t.fill&&this.context.fillText(i[o],p,u+this._style.padding)}this.updateTexture()},s.prototype.updateTexture=function(){var t=this._texture;this.cacheDirty&&(t.baseTexture.hasLoaded=!0,t.baseTexture.resolution=this.resolution,t.baseTexture.width=this.canvas.width/this.resolution,t.baseTexture.height=this.canvas.height/this.resolution),t.crop.width=t._frame.width=this.canvas.width/this.resolution,t.crop.height=t._frame.height=this.canvas.height/this.resolution,t.trim.x=0,t.trim.y=-this._style.padding,t.trim.width=t._frame.width,t.trim.height=t._frame.height-2*this._style.padding,this._width=this.canvas.width/this.resolution,this._height=this.canvas.height/this.resolution,this.scale.x=1,this.scale.y=1,this.cacheDirty&&t.baseTexture.emit("update",t.baseTexture),this.dirty=!1,this.cacheDirty=!1},s.prototype.renderWebGL=function(t){this.dirty&&this.updateText(),r.Sprite.prototype.renderWebGL.call(this,t)},s.prototype._renderCanvas=function(t){this.dirty&&this.updateText(),r.Sprite.prototype._renderCanvas.call(this,t)},s.prototype.getBounds=function(t){return this.dirty&&this.updateText(),r.Sprite.prototype.getBounds.call(this,t)},s.prototype.destroy=function(t){this.context=null,this.canvas=null,this._style=null,this._texture.destroy(void 0===t?!0:t)}},{"../CocoonTextUtil":2,"pixi.js":"pixi.js"}]},{},[1]);